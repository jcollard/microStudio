<div class="step-content">
    <h2>Step 3: Replace init_enemies()</h2>

    <p>Now that you have a working <code>spawn_enemy()</code> function, let's refactor <code>init_enemies()</code> to use it. This is a perfect example of how creating reusable functions pays offâ€”you'll replace dozens of lines of repetitive code with a single function call!</p>

    <div class="info-box">
        <h3>The Power of Abstraction</h3>
        <p>Your <code>init_enemies()</code> manually creates every enemy. By using <code>spawn_enemy()</code>, you get less code, consistency, and flexibilityâ€”one function call instead of 5-10 lines per enemy.</p>
    </div>

    <h3>Your Task</h3>

    <p>Refactor your <code>init_enemies()</code> function to use <code>spawn_enemy()</code> instead of manually creating enemies. For now, we'll start with just <strong>one enemy</strong> to keep things simple.</p>

    <h3>The Changes</h3>

    <p>Here's what the refactored code looks like. Notice how much simpler it becomes:</p>

    <div id="init-enemies-diff"></div>

    <script>
        const oldInit = `function init_enemies()
  enemies = {}

  -- LEFT EYE
  local left_eye = create_enemy("googlya", 28, 28)
  left_eye.x = 0
  left_eye.y = 0
  left_eye.vx = 0.7
  left_eye.vy = 0.57575
  left_eye.color = "#FF00FF"
  left_eye.rotation_speed = 12

  -- RIGHT EYE
  local right_eye = create_enemy("googlyb", 28, 28)
  right_eye.x = 0
  right_eye.y = 0
  right_eye.vx = -0.6
  right_eye.vy = 0.37575
  right_eye.color = "#00FFFF"
  right_eye.rotation_speed = -12

  -- FIRST ENEMY
  local enemy1 = create_enemy("enemy_ship", 32, 32)
  enemy1.x = 50
  enemy1.y = 50
  enemy1.vx = 0.5
  enemy1.vy = 0.3

  -- SECOND ENEMY
  local enemy2 = create_enemy("enemy_ship", 32, 32)
  enemy2.x = -50
  enemy2.y = -50
  enemy2.vx = -0.4
  enemy2.vy = -0.4
end`;

        const newInit = `function init_enemies()
  enemies = {}

  -- Spawn 1 enemy at the start
  spawn_enemy()
end`;

        renderDiffBlock('init-enemies-diff', oldInit, newInit, 'Refactor init_enemies() to use spawn_enemy()');
    </script>


    <h3>Testing</h3>

    <p>Run your gameâ€”one enemy should spawn at the top with random movement. All existing functionality should still work.</p>

    <div class="info-box">
        <h3>ðŸŽ® Try This!</h3>
        <p>Want more enemies at the start? Just call <code>spawn_enemy()</code> multiple times:</p>
        <pre><code>function init_enemies()
  enemies = {}

  -- Spawn 5 enemies at the start
  spawn_enemy()
  spawn_enemy()
  spawn_enemy()
  spawn_enemy()
  spawn_enemy()
end</code></pre>
        <p>This would have required <strong>165 lines of code</strong> with the old approach. Now it's just 5 function calls!</p>
    </div>

    <div class="success-box">
        <h3>Don't Repeat Yourself (DRY)</h3>
        <p>You've reduced 33 lines to 5 by centralizing enemy spawning logic. Changes now happen in one place, making code more maintainable, readable, and flexible.</p>
    </div>
</div>
